version: '3'

services:
  nginx:
    image: jwilder/nginx-proxy
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock:ro
    ports:
      - "80:80"
      - "443:443"
    networks:
      - webnet

  letsencrypt:
    image: jrcs/letsencrypt-nginx-proxy-companion
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    environment:
      - NGINX_PROXY_CONTAINER=nginx
      - ACME_EMAIL=1985615319@qq.com  # 替换为您的邮箱
    networks:
      - webnet

  blog_plus:
    image: weijordan/blog_plus:latest
    container_name: blog_plus
    ports:
      - "3002:80"  # 将容器的80端口映射到宿主机的3002端口
    volumes:
      - /myDocker/blog_plus:/app
    environment:
      - VIRTUAL_HOST=weijordan.com,www.weijordan.com,blog.weijordan.com  # 替换为您的域名，用逗号分隔
      - LETSENCRYPT_HOST=weijordan.com,www.weijordan.com,blog.weijordan.com  # 替换为您的域名
      - LETSENCRYPT_EMAIL=1985615319@qq.com  # 替换为您的邮箱
    restart: unless-stopped
    networks:
      - webnet

networks:
  webnet:

  # 运行容器
  # docker-compose up -d
  # 检查运行情况
  # docker-compose ps
  # 停止并移除容器
  # docker-compose down
  # 停止容器
  # docker-compose stop
  # 启动容器
  # docker-compose start
  # 重启容器
  # docker-compose restart
